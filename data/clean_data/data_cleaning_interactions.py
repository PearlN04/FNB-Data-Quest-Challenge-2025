{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "563e0cb0-18ef-4431-bd23-c4a8c5808bdb",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>idcol</th>\n",
       "      <th>interaction</th>\n",
       "      <th>int_date</th>\n",
       "      <th>item</th>\n",
       "      <th>page</th>\n",
       "      <th>tod</th>\n",
       "      <th>item_type</th>\n",
       "      <th>item_descrip</th>\n",
       "      <th>segment</th>\n",
       "      <th>beh_segment</th>\n",
       "      <th>active_ind</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>755</td>\n",
       "      <td>DISPLAY</td>\n",
       "      <td>17-Jan-23</td>\n",
       "      <td>NONE</td>\n",
       "      <td>Screen1</td>\n",
       "      <td>Afternoon</td>\n",
       "      <td>ALL</td>\n",
       "      <td>NaN</td>\n",
       "      <td>segment3</td>\n",
       "      <td>B01</td>\n",
       "      <td>Semi Active</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>4521</td>\n",
       "      <td>DISPLAY</td>\n",
       "      <td>27-Feb-23</td>\n",
       "      <td>NONE</td>\n",
       "      <td>Screen1</td>\n",
       "      <td>Afternoon</td>\n",
       "      <td>ALL</td>\n",
       "      <td>NaN</td>\n",
       "      <td>segment1</td>\n",
       "      <td>B07</td>\n",
       "      <td>Semi Active</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>4521</td>\n",
       "      <td>DISPLAY</td>\n",
       "      <td>18-Feb-23</td>\n",
       "      <td>NONE</td>\n",
       "      <td>Screen1</td>\n",
       "      <td>Afternoon</td>\n",
       "      <td>ALL</td>\n",
       "      <td>NaN</td>\n",
       "      <td>segment1</td>\n",
       "      <td>B07</td>\n",
       "      <td>Semi Active</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4521</td>\n",
       "      <td>DISPLAY</td>\n",
       "      <td>30-Jan-23</td>\n",
       "      <td>NONE</td>\n",
       "      <td>Screen1</td>\n",
       "      <td>Morning</td>\n",
       "      <td>ALL</td>\n",
       "      <td>NaN</td>\n",
       "      <td>segment1</td>\n",
       "      <td>B07</td>\n",
       "      <td>Semi Active</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4521</td>\n",
       "      <td>CLICK</td>\n",
       "      <td>5-Feb-23</td>\n",
       "      <td>IBAB</td>\n",
       "      <td>Screen1</td>\n",
       "      <td>Afternoon</td>\n",
       "      <td>INSURE</td>\n",
       "      <td>GENERIC MESSAGE</td>\n",
       "      <td>segment1</td>\n",
       "      <td>B07</td>\n",
       "      <td>Semi Active</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   idcol interaction   int_date  item     page        tod item_type  \\\n",
       "0    755     DISPLAY  17-Jan-23  NONE  Screen1  Afternoon       ALL   \n",
       "1   4521     DISPLAY  27-Feb-23  NONE  Screen1  Afternoon       ALL   \n",
       "2   4521     DISPLAY  18-Feb-23  NONE  Screen1  Afternoon       ALL   \n",
       "3   4521     DISPLAY  30-Jan-23  NONE  Screen1    Morning       ALL   \n",
       "4   4521       CLICK   5-Feb-23  IBAB  Screen1  Afternoon    INSURE   \n",
       "\n",
       "      item_descrip   segment beh_segment   active_ind  \n",
       "0              NaN  segment3         B01  Semi Active  \n",
       "1              NaN  segment1         B07  Semi Active  \n",
       "2              NaN  segment1         B07  Semi Active  \n",
       "3              NaN  segment1         B07  Semi Active  \n",
       "4  GENERIC MESSAGE  segment1         B07  Semi Active  "
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import pandas as pd\n",
    "\n",
    "# Load the CSV file\n",
    "df = pd.read_csv('C:/Users/nonts/OneDrive - University of Cape Town/FNB_DataQuest_Challenge_2025/data/raw/fnb_raw_data.csv')\n",
    "\n",
    "df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "f3b23677-afc7-469a-99d6-b0e10dbfd62c",
   "metadata": {},
   "outputs": [
    {
     "ename": "NameError",
     "evalue": "name 'idcol' is not defined",
     "output_type": "error",
     "traceback": [
      "\u001b[31m---------------------------------------------------------------------------\u001b[39m",
      "\u001b[31mNameError\u001b[39m                                 Traceback (most recent call last)",
      "\u001b[36mCell\u001b[39m\u001b[36m \u001b[39m\u001b[32mIn[2]\u001b[39m\u001b[32m, line 1\u001b[39m\n\u001b[32m----> \u001b[39m\u001b[32m1\u001b[39m df[\u001b[43midcol\u001b[49m].isnull().sum()\n",
      "\u001b[31mNameError\u001b[39m: name 'idcol' is not defined"
     ]
    }
   ],
   "source": [
    "df[idcol].isnull().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "6efb4d88-ad68-42b8-8b8c-9238380579e1",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "np.int64(0)"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df['idcol'].isnull().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "f593579c-d8f1-4c8c-9b14-b6549eab7f44",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "No missing data!\n"
     ]
    }
   ],
   "source": [
    "missing = df['idcol'].isnull().sum()\n",
    "\n",
    "if missing == 0:\n",
    "    print(\"No missing data!\")\n",
    "else:\n",
    "    print(f\"Missing {missing} values\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "27528136-32cd-4a45-a6f0-17fa41a85ed9",
   "metadata": {},
   "outputs": [],
   "source": [
    "df = df[df['idcol'].astype(str).str.isnumeric()]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "2b5d9548-3ded-4efa-b675-379eb6151e2a",
   "metadata": {},
   "outputs": [],
   "source": [
    "df[['idcol']].to_csv('cleaned_idcol.csv', index=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "eb9f31d2-4c74-4244-8e34-16e94c2785c0",
   "metadata": {},
   "outputs": [],
   "source": [
    "allowed_interactions = {'DISPLAY', 'CLICK', 'CHECKOUT'}\n",
    "invalid_rows = df[~df['interaction'].isin(allowed_interactions)]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "49010374-1fdc-4f38-a143-78d70a76e5eb",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "All rows have valid interactions.\n"
     ]
    }
   ],
   "source": [
    "allowed_interactions = {'DISPLAY', 'CLICK', 'CHECKOUT'}\n",
    "invalid_rows = df[~df['interaction'].isin(allowed_interactions)]\n",
    "if invalid_rows.empty:\n",
    "    print(\"All rows have valid interactions.\")\n",
    "else:\n",
    "    print(\"Rows with invalid interactions found:\")\n",
    "    print(invalid_rows)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "ee0baee5-31c6-46f9-9300-9d1eabf9f758",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "All rows have valid interactions.\n"
     ]
    }
   ],
   "source": [
    "allowed_interactions = {'Early', 'Morning', 'Afternoon','Evening'}     #check for invalid tod values\n",
    "invalid_rows = df[~df['tod'].isin(allowed_interactions)]\n",
    "if invalid_rows.empty:\n",
    "    print(\"All rows have valid interactions.\")\n",
    "else:\n",
    "    print(\"Rows with invalid interactions found:\")\n",
    "    print(invalid_rows)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "247c9699-7965-4a0d-a5b2-6d5c7643763c",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Rows with invalid interactions found:\n",
      "              idcol interaction   int_date  item     page        tod  \\\n",
      "0               755     DISPLAY  17-Jan-23  NONE  Screen1  Afternoon   \n",
      "1              4521     DISPLAY  27-Feb-23  NONE  Screen1  Afternoon   \n",
      "2              4521     DISPLAY  18-Feb-23  NONE  Screen1  Afternoon   \n",
      "3              4521     DISPLAY  30-Jan-23  NONE  Screen1    Morning   \n",
      "6              6145     DISPLAY  26-Feb-23  NONE  Screen1    Evening   \n",
      "...             ...         ...        ...   ...      ...        ...   \n",
      "399982  25728632418     DISPLAY  14-Mar-23  NONE  Screen1    Morning   \n",
      "399983  25728632418     DISPLAY   2-Jan-23  NONE  Screen1    Morning   \n",
      "399984  25728632418     DISPLAY  11-Mar-23  NONE  Screen1    Morning   \n",
      "399985  25728632418     DISPLAY   7-Mar-23  NONE  Screen1    Evening   \n",
      "399986  25728632418     DISPLAY  12-Mar-23  NONE  Screen1    Evening   \n",
      "\n",
      "       item_type item_descrip   segment beh_segment   active_ind  \n",
      "0            ALL          NaN  segment3         B01  Semi Active  \n",
      "1            ALL          NaN  segment1         B07  Semi Active  \n",
      "2            ALL          NaN  segment1         B07  Semi Active  \n",
      "3            ALL          NaN  segment1         B07  Semi Active  \n",
      "6            ALL          NaN  segment3         B01   Cold Start  \n",
      "...          ...          ...       ...         ...          ...  \n",
      "399982       ALL          NaN  segment1         B27   Cold Start  \n",
      "399983       ALL          NaN  segment1         B27   Cold Start  \n",
      "399984       ALL          NaN  segment1         B27   Cold Start  \n",
      "399985       ALL          NaN  segment1         B27   Cold Start  \n",
      "399986       ALL          NaN  segment1         B27   Cold Start  \n",
      "\n",
      "[173638 rows x 11 columns]\n"
     ]
    }
   ],
   "source": [
    "allowed_interactions = {'TRANSACT', 'LEND', 'INVEST', 'INSURE', 'CONNECT','LIFESTYLE' }     #check for invalid item_type values\n",
    "invalid_rows = df[~df['item_type'].isin(allowed_interactions)]\n",
    "if invalid_rows.empty:\n",
    "    print(\"All rows have valid interactions.\")\n",
    "else:\n",
    "    print(\"Rows with invalid interactions found:\")\n",
    "    print(invalid_rows)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "3ab06589-d0c7-4986-ba41-d679255378ab",
   "metadata": {},
   "outputs": [],
   "source": [
    "df.loc[df['interaction'] == 'DISPLAY', 'item_descrip'] = 'Displayed all items' #fill empty cells in the description column with displayed all items"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "83e0d7c4-33e2-4dc8-993a-184f5629f410",
   "metadata": {},
   "outputs": [],
   "source": [
    "df[['item_descrip']].to_csv('cleaned_description.csv', index=False) #save the description column to check if it contains any null values"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "1d513482-e581-4b11-9c51-171b2cd27409",
   "metadata": {},
   "outputs": [],
   "source": [
    "df.loc[df['interaction'] == 'DISPLAY', 'item_descrip'] = 'DISPLAYED ALL ITEMS' "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "467cfcc6-efa0-4f22-843a-7b80b4746492",
   "metadata": {},
   "outputs": [],
   "source": [
    "df[['item_descrip']].to_csv('cleaned_description.csv', index=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "e5190077-ed8e-4fcb-946e-099972c62866",
   "metadata": {},
   "outputs": [
    {
     "ename": "OSError",
     "evalue": "Cannot save file into a non-existent directory: 'C:\\Users\\nonts\\OneDrive - University of Cape Town\\FNB_DataQuest_Challenge_2025\\data\\clean'",
     "output_type": "error",
     "traceback": [
      "\u001b[31m---------------------------------------------------------------------------\u001b[39m",
      "\u001b[31mOSError\u001b[39m                                   Traceback (most recent call last)",
      "\u001b[36mCell\u001b[39m\u001b[36m \u001b[39m\u001b[32mIn[18]\u001b[39m\u001b[32m, line 1\u001b[39m\n\u001b[32m----> \u001b[39m\u001b[32m1\u001b[39m \u001b[43mdf\u001b[49m\u001b[43m.\u001b[49m\u001b[43mto_csv\u001b[49m\u001b[43m(\u001b[49m\u001b[33;43m'\u001b[39;49m\u001b[33;43mC:/Users/nonts/OneDrive - University of Cape Town/FNB_DataQuest_Challenge_2025/data/clean/cleaned_data.csv\u001b[39;49m\u001b[33;43m'\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mindex\u001b[49m\u001b[43m=\u001b[49m\u001b[38;5;28;43;01mFalse\u001b[39;49;00m\u001b[43m)\u001b[49m\n",
      "\u001b[36mFile \u001b[39m\u001b[32m~\\AppData\\Local\\Packages\\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\\LocalCache\\local-packages\\Python311\\site-packages\\pandas\\util\\_decorators.py:333\u001b[39m, in \u001b[36mdeprecate_nonkeyword_arguments.<locals>.decorate.<locals>.wrapper\u001b[39m\u001b[34m(*args, **kwargs)\u001b[39m\n\u001b[32m    327\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mlen\u001b[39m(args) > num_allow_args:\n\u001b[32m    328\u001b[39m     warnings.warn(\n\u001b[32m    329\u001b[39m         msg.format(arguments=_format_argument_list(allow_args)),\n\u001b[32m    330\u001b[39m         \u001b[38;5;167;01mFutureWarning\u001b[39;00m,\n\u001b[32m    331\u001b[39m         stacklevel=find_stack_level(),\n\u001b[32m    332\u001b[39m     )\n\u001b[32m--> \u001b[39m\u001b[32m333\u001b[39m \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43mfunc\u001b[49m\u001b[43m(\u001b[49m\u001b[43m*\u001b[49m\u001b[43margs\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43m*\u001b[49m\u001b[43m*\u001b[49m\u001b[43mkwargs\u001b[49m\u001b[43m)\u001b[49m\n",
      "\u001b[36mFile \u001b[39m\u001b[32m~\\AppData\\Local\\Packages\\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\\LocalCache\\local-packages\\Python311\\site-packages\\pandas\\core\\generic.py:3967\u001b[39m, in \u001b[36mNDFrame.to_csv\u001b[39m\u001b[34m(self, path_or_buf, sep, na_rep, float_format, columns, header, index, index_label, mode, encoding, compression, quoting, quotechar, lineterminator, chunksize, date_format, doublequote, escapechar, decimal, errors, storage_options)\u001b[39m\n\u001b[32m   3956\u001b[39m df = \u001b[38;5;28mself\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(\u001b[38;5;28mself\u001b[39m, ABCDataFrame) \u001b[38;5;28;01melse\u001b[39;00m \u001b[38;5;28mself\u001b[39m.to_frame()\n\u001b[32m   3958\u001b[39m formatter = DataFrameFormatter(\n\u001b[32m   3959\u001b[39m     frame=df,\n\u001b[32m   3960\u001b[39m     header=header,\n\u001b[32m   (...)\u001b[39m\u001b[32m   3964\u001b[39m     decimal=decimal,\n\u001b[32m   3965\u001b[39m )\n\u001b[32m-> \u001b[39m\u001b[32m3967\u001b[39m \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43mDataFrameRenderer\u001b[49m\u001b[43m(\u001b[49m\u001b[43mformatter\u001b[49m\u001b[43m)\u001b[49m\u001b[43m.\u001b[49m\u001b[43mto_csv\u001b[49m\u001b[43m(\u001b[49m\n\u001b[32m   3968\u001b[39m \u001b[43m    \u001b[49m\u001b[43mpath_or_buf\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m   3969\u001b[39m \u001b[43m    \u001b[49m\u001b[43mlineterminator\u001b[49m\u001b[43m=\u001b[49m\u001b[43mlineterminator\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m   3970\u001b[39m \u001b[43m    \u001b[49m\u001b[43msep\u001b[49m\u001b[43m=\u001b[49m\u001b[43msep\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m   3971\u001b[39m \u001b[43m    \u001b[49m\u001b[43mencoding\u001b[49m\u001b[43m=\u001b[49m\u001b[43mencoding\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m   3972\u001b[39m \u001b[43m    \u001b[49m\u001b[43merrors\u001b[49m\u001b[43m=\u001b[49m\u001b[43merrors\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m   3973\u001b[39m \u001b[43m    \u001b[49m\u001b[43mcompression\u001b[49m\u001b[43m=\u001b[49m\u001b[43mcompression\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m   3974\u001b[39m \u001b[43m    \u001b[49m\u001b[43mquoting\u001b[49m\u001b[43m=\u001b[49m\u001b[43mquoting\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m   3975\u001b[39m \u001b[43m    \u001b[49m\u001b[43mcolumns\u001b[49m\u001b[43m=\u001b[49m\u001b[43mcolumns\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m   3976\u001b[39m \u001b[43m    \u001b[49m\u001b[43mindex_label\u001b[49m\u001b[43m=\u001b[49m\u001b[43mindex_label\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m   3977\u001b[39m \u001b[43m    \u001b[49m\u001b[43mmode\u001b[49m\u001b[43m=\u001b[49m\u001b[43mmode\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m   3978\u001b[39m \u001b[43m    \u001b[49m\u001b[43mchunksize\u001b[49m\u001b[43m=\u001b[49m\u001b[43mchunksize\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m   3979\u001b[39m \u001b[43m    \u001b[49m\u001b[43mquotechar\u001b[49m\u001b[43m=\u001b[49m\u001b[43mquotechar\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m   3980\u001b[39m \u001b[43m    \u001b[49m\u001b[43mdate_format\u001b[49m\u001b[43m=\u001b[49m\u001b[43mdate_format\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m   3981\u001b[39m \u001b[43m    \u001b[49m\u001b[43mdoublequote\u001b[49m\u001b[43m=\u001b[49m\u001b[43mdoublequote\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m   3982\u001b[39m \u001b[43m    \u001b[49m\u001b[43mescapechar\u001b[49m\u001b[43m=\u001b[49m\u001b[43mescapechar\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m   3983\u001b[39m \u001b[43m    \u001b[49m\u001b[43mstorage_options\u001b[49m\u001b[43m=\u001b[49m\u001b[43mstorage_options\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m   3984\u001b[39m \u001b[43m\u001b[49m\u001b[43m)\u001b[49m\n",
      "\u001b[36mFile \u001b[39m\u001b[32m~\\AppData\\Local\\Packages\\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\\LocalCache\\local-packages\\Python311\\site-packages\\pandas\\io\\formats\\format.py:1014\u001b[39m, in \u001b[36mDataFrameRenderer.to_csv\u001b[39m\u001b[34m(self, path_or_buf, encoding, sep, columns, index_label, mode, compression, quoting, quotechar, lineterminator, chunksize, date_format, doublequote, escapechar, errors, storage_options)\u001b[39m\n\u001b[32m    993\u001b[39m     created_buffer = \u001b[38;5;28;01mFalse\u001b[39;00m\n\u001b[32m    995\u001b[39m csv_formatter = CSVFormatter(\n\u001b[32m    996\u001b[39m     path_or_buf=path_or_buf,\n\u001b[32m    997\u001b[39m     lineterminator=lineterminator,\n\u001b[32m   (...)\u001b[39m\u001b[32m   1012\u001b[39m     formatter=\u001b[38;5;28mself\u001b[39m.fmt,\n\u001b[32m   1013\u001b[39m )\n\u001b[32m-> \u001b[39m\u001b[32m1014\u001b[39m \u001b[43mcsv_formatter\u001b[49m\u001b[43m.\u001b[49m\u001b[43msave\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m   1016\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m created_buffer:\n\u001b[32m   1017\u001b[39m     \u001b[38;5;28;01massert\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(path_or_buf, StringIO)\n",
      "\u001b[36mFile \u001b[39m\u001b[32m~\\AppData\\Local\\Packages\\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\\LocalCache\\local-packages\\Python311\\site-packages\\pandas\\io\\formats\\csvs.py:251\u001b[39m, in \u001b[36mCSVFormatter.save\u001b[39m\u001b[34m(self)\u001b[39m\n\u001b[32m    247\u001b[39m \u001b[38;5;250m\u001b[39m\u001b[33;03m\"\"\"\u001b[39;00m\n\u001b[32m    248\u001b[39m \u001b[33;03mCreate the writer & save.\u001b[39;00m\n\u001b[32m    249\u001b[39m \u001b[33;03m\"\"\"\u001b[39;00m\n\u001b[32m    250\u001b[39m \u001b[38;5;66;03m# apply compression and byte/text conversion\u001b[39;00m\n\u001b[32m--> \u001b[39m\u001b[32m251\u001b[39m \u001b[38;5;28;01mwith\u001b[39;00m \u001b[43mget_handle\u001b[49m\u001b[43m(\u001b[49m\n\u001b[32m    252\u001b[39m \u001b[43m    \u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43mfilepath_or_buffer\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m    253\u001b[39m \u001b[43m    \u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43mmode\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m    254\u001b[39m \u001b[43m    \u001b[49m\u001b[43mencoding\u001b[49m\u001b[43m=\u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43mencoding\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m    255\u001b[39m \u001b[43m    \u001b[49m\u001b[43merrors\u001b[49m\u001b[43m=\u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43merrors\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m    256\u001b[39m \u001b[43m    \u001b[49m\u001b[43mcompression\u001b[49m\u001b[43m=\u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43mcompression\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m    257\u001b[39m \u001b[43m    \u001b[49m\u001b[43mstorage_options\u001b[49m\u001b[43m=\u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43mstorage_options\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m    258\u001b[39m \u001b[43m\u001b[49m\u001b[43m)\u001b[49m \u001b[38;5;28;01mas\u001b[39;00m handles:\n\u001b[32m    259\u001b[39m     \u001b[38;5;66;03m# Note: self.encoding is irrelevant here\u001b[39;00m\n\u001b[32m    260\u001b[39m     \u001b[38;5;28mself\u001b[39m.writer = csvlib.writer(\n\u001b[32m    261\u001b[39m         handles.handle,\n\u001b[32m    262\u001b[39m         lineterminator=\u001b[38;5;28mself\u001b[39m.lineterminator,\n\u001b[32m   (...)\u001b[39m\u001b[32m    267\u001b[39m         quotechar=\u001b[38;5;28mself\u001b[39m.quotechar,\n\u001b[32m    268\u001b[39m     )\n\u001b[32m    270\u001b[39m     \u001b[38;5;28mself\u001b[39m._save()\n",
      "\u001b[36mFile \u001b[39m\u001b[32m~\\AppData\\Local\\Packages\\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\\LocalCache\\local-packages\\Python311\\site-packages\\pandas\\io\\common.py:749\u001b[39m, in \u001b[36mget_handle\u001b[39m\u001b[34m(path_or_buf, mode, encoding, compression, memory_map, is_text, errors, storage_options)\u001b[39m\n\u001b[32m    747\u001b[39m \u001b[38;5;66;03m# Only for write methods\u001b[39;00m\n\u001b[32m    748\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m \u001b[33m\"\u001b[39m\u001b[33mr\u001b[39m\u001b[33m\"\u001b[39m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;129;01min\u001b[39;00m mode \u001b[38;5;129;01mand\u001b[39;00m is_path:\n\u001b[32m--> \u001b[39m\u001b[32m749\u001b[39m     \u001b[43mcheck_parent_directory\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;28;43mstr\u001b[39;49m\u001b[43m(\u001b[49m\u001b[43mhandle\u001b[49m\u001b[43m)\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    751\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m compression:\n\u001b[32m    752\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m compression != \u001b[33m\"\u001b[39m\u001b[33mzstd\u001b[39m\u001b[33m\"\u001b[39m:\n\u001b[32m    753\u001b[39m         \u001b[38;5;66;03m# compression libraries do not like an explicit text-mode\u001b[39;00m\n",
      "\u001b[36mFile \u001b[39m\u001b[32m~\\AppData\\Local\\Packages\\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\\LocalCache\\local-packages\\Python311\\site-packages\\pandas\\io\\common.py:616\u001b[39m, in \u001b[36mcheck_parent_directory\u001b[39m\u001b[34m(path)\u001b[39m\n\u001b[32m    614\u001b[39m parent = Path(path).parent\n\u001b[32m    615\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m parent.is_dir():\n\u001b[32m--> \u001b[39m\u001b[32m616\u001b[39m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mOSError\u001b[39;00m(\u001b[33mrf\u001b[39m\u001b[33m\"\u001b[39m\u001b[33mCannot save file into a non-existent directory: \u001b[39m\u001b[33m'\u001b[39m\u001b[38;5;132;01m{\u001b[39;00mparent\u001b[38;5;132;01m}\u001b[39;00m\u001b[33m'\u001b[39m\u001b[33m\"\u001b[39m)\n",
      "\u001b[31mOSError\u001b[39m: Cannot save file into a non-existent directory: 'C:\\Users\\nonts\\OneDrive - University of Cape Town\\FNB_DataQuest_Challenge_2025\\data\\clean'"
     ]
    }
   ],
   "source": [
    "df.to_csv('C:/Users/nonts/OneDrive - University of Cape Town/FNB_DataQuest_Challenge_2025/data/clean/cleaned_data.csv', index=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "57225b08-f6ca-48b5-9870-788ea8506f5f",
   "metadata": {},
   "outputs": [],
   "source": [
    "df[[]].to_csv('cleaned_data.csv', index=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "34088512-5858-4537-9c9e-57aa78f6f6e0",
   "metadata": {},
   "outputs": [],
   "source": [
    "df.to_csv('cleaned_data.csv', index=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "b95a28bd-9fa5-4296-8fdd-f75af2cd1fd9",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Number of duplicate rows: 30317\n",
      "              idcol interaction   int_date  item     page        tod  \\\n",
      "63            28951       CLICK   9-Jan-23  CBPB  Screen1    Morning   \n",
      "110           49398       CLICK  19-Mar-23  CUPL  Screen1    Morning   \n",
      "124           55558       CLICK   8-Feb-23  MMMC  Screen1    Evening   \n",
      "137           57490       CLICK  15-Mar-23  IBAC  Screen1  Afternoon   \n",
      "138           57490       CLICK  15-Mar-23  IBAC  Screen1  Afternoon   \n",
      "...             ...         ...        ...   ...      ...        ...   \n",
      "399970  25693117918       CLICK  26-Mar-23  CBPB  Screen1  Afternoon   \n",
      "399972  25693117918       CLICK  26-Mar-23  CBPB  Screen1  Afternoon   \n",
      "399976  25705258018       CLICK  26-Mar-23  CBPB  Screen2    Evening   \n",
      "399990  25728632418       CLICK  13-Jan-23  IBAC  Screen2  Afternoon   \n",
      "399992  25728632418       CLICK   7-Feb-23  IBAC  Screen2  Afternoon   \n",
      "\n",
      "        item_type   item_descrip   segment beh_segment   active_ind  \n",
      "63        CONNECT      POWERBALL  segment1         B07  Semi Active  \n",
      "110          LEND   PLS NEW LOAN  segment2         B02       Active  \n",
      "124     LIFESTYLE    MONEY COACH  segment3         B18  Semi Active  \n",
      "137        INSURE  FUNERAL COVER  segment1         B01   Cold Start  \n",
      "138        INSURE  FUNERAL COVER  segment1         B01   Cold Start  \n",
      "...           ...            ...       ...         ...          ...  \n",
      "399970    CONNECT      POWERBALL  segment1         B18   Cold Start  \n",
      "399972    CONNECT      POWERBALL  segment1         B18   Cold Start  \n",
      "399976    CONNECT      POWERBALL  segment1         B18   Cold Start  \n",
      "399990     INSURE  FUNERAL COVER  segment1         B27   Cold Start  \n",
      "399992     INSURE  FUNERAL COVER  segment1         B27   Cold Start  \n",
      "\n",
      "[30317 rows x 11 columns]\n"
     ]
    }
   ],
   "source": [
    "# This will give a boolean Series showing True for rows that are duplicates (except the first occurrence)\n",
    "duplicates = df.duplicated()\n",
    "\n",
    "# To see how many duplicates there are:\n",
    "print(\"Number of duplicate rows:\", duplicates.sum())\n",
    "\n",
    "# To view the duplicate rows themselves:\n",
    "print(df[duplicates])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "4a6d4a75-fffd-420d-87ca-3db239420b67",
   "metadata": {},
   "outputs": [],
   "source": [
    "df.to_csv('cleaned_data.csv', index=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3d9435c2-54ff-49e9-b754-9f349b799dc9",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.9"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
